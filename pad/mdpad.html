<html>
    <head>
        <title>MarkDownPad</title>
        <!--
            <link href="atom-one-dark.css" rel="stylesheet">
            <script src="highlight.min.js"></script>
            <link href="simplemde.min.css" rel="stylesheet">
        <script src="simplemde.min.js" type="text/javascript"></script> 
        -->
        <link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/atom-one-dark.css">
        <script src="https:///cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
        <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
        <meta charset="UTF-8">
        <style>
            body {
                height: 100vh;
                width: 100vw;
                margin: 0;
                padding: 0px;
                display: table;
            }
            .editor-statusbar, .editor-toolbar {
                height: 1px;
                display: table-row;
            }
            .CodeMirror-wrap {
                height: 100%;
            }
        </style>
    </head>
    <body>
        <textarea id="editor-container"></textarea>
        <script>
            hljs.configure({
                languages: ['javascript', 'html', 'css', 'json', 'markdown', 'xml']
            });


            let simplemde = new SimpleMDE({
                element: document.getElementById('editor-container'),
                toolbar: ['heading-1', 'heading-2', 'heading-3', '|',
                    'bold', 'italic', 'strikethrough', '|',
                    'quote', 'code', '|',
                    'ordered-list', 'unordered-list', '|',
                    'link', 'image', 'table', '|',
                    'preview', 'guide'],
                // status: false,
                placeholder: 'Write stuff!',
                renderingConfig: {
                    codeSyntaxHighlighting: true,
                }
            });

            // Initial setup
            const loadedContent = localStorage.getItem('mdePad');
            if (loadedContent) simplemde.value(loadedContent);

            // Unsaved data check
            let changesSinceLastSave = false;
            simplemde.codemirror.on('change', function() {
                changesSinceLastSave = true;
            });

            function save() {
                if (changesSinceLastSave) {
                    const contents = simplemde.value();
                    localStorage.setItem('mdePad', contents);
                    changesSinceLastSave = false;
                }
            }

            // Save periodically
            setInterval(save, 10*1000);

            // Save on window close
            window.onbeforeunload = save;
        </script>
    </body>
</html>
